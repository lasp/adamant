\input{common_packages.tex}

\begin{document}

\title{\textbf{Ccsds Downsampler Generator} \\
\large\textit{Autocoder User Guide}}
\date{}
\maketitle

\section{Description}

The purpose of this generator is to provide the user a way to define the packets that they would like downsampled. The generator takes a YAML model file as an input from which it constructs an Ada specification file that contains a list as the input parameter for initialization in the component. The component is required to know the Apid of the desired packets to be downsampled as well as the filtering factor to downsample the packets. The generator will also create data products of the filter factor for each of the specified Apids in the list.

Note the example shown in this documentation is used in the unit test of this component so that the reader of this document can see it being used in context. Please refer to the unit test code for more details on how this generator can be used.

\section{Schema}

The following pykwalify schema is used to validate the input YAML model. Model files must be named in the form \textit{assembly\_name.ccsds\_downsampler\_filters.yaml}. The \textit{assembly\_name} is the assembly which these packets will be downsampled in, and the rest of the model file name must remain as shown. Generally this file is created in the same directory or near to the assembly model file. The schema is commented to show what each of the available YAML keys are and what they accomplish. Even without knowing the specifics of pykwalify schemas, you should be able to gleam some knowledge from the file below.

\yamlcodef{../schemas/ccsds_downsampler_filters.yaml}

\section{Example Input}

The following shows an example input YAML model that is used in the unit testing for the downsampler component. The example attempts to use all the variations of the optional inputs so that the user can see how they can use the options to generate their own desired input. Generally this file is created in the same directory or near to the assembly model file. This example adheres to the schema shown in the previous section, and is commented to give clarification.

\yamlcodef{../../test/test_assembly/test_downsample_list.ccsds_downsampler_filters.yaml}

As can be seen, specifying a packet to downsample simply consists of listing the Apid for that packet and the corresponding filter factor. There is also the capability to include a name which will be used as the name of the generated data product. If no name is specified, the generator will use a autogenerated name using the Apid. 

\section{Example Output}

The example input shown in the previous section produces the following Ada output. The \texttt{Downsample\_List} variable should be passed into the Ccsds Downsampler component's \texttt{Init} procedure during assembly initialization.

The main job of the generator in this case was to verify the input YAML for validity and then to translate the data to an Ada data structure for use by the component. The generator will also create data products as was mentioned before in this document

\adacodef{../../test/test_assembly/build/src/test_downsample_list.ads}

\end{document}
