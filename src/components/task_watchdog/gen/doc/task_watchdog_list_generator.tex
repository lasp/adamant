\input{common_packages.tex}

\begin{document}

\title{\textbf{Task Watchdog Generator} \\
\large\textit{Autocoder User Guide}}
\date{}
\maketitle

\section{Description}

The purpose of this generator is to provide the user a way to define the components that the system will use to perform watchdog checks on. The connector used with this is a Pet connector. This connection will be monitored and if there is not a response from the component within a specified amount of ticks, which is a limit that is defined in the model file by the user, then an action is taken (again specified by the user) to either do nothing, issue a warning event, or issue an event and fault. The current state of each petter is dynamically created into a data product to be sent anytime they are updated. There is also a data product produced for each limit of the petters defined. In addition to the data products, faults are also dynamically created from the petters where a fault id is defined. This indicates a fault should be created which will allow state transitions into the faulted state, even if not defined that way at the start.

The user can also defined a criticality of the petter. If the petter is not disabled, when a pet is not received from that connection exceeding the limit, then the critical flag is tripped which will stop the downstream petting of the task watchdog component.

Note the example shown in this documentation is used in the unit test of this component so that the reader of this document can see it being used in context. Please refer to the unit test code for more details on how this generator can be used.

\section{Schema}

The following pykwalify schema is used to validate the input YAML model. Model files must be named in the form \textit{assembly\_name.task\_watchdog\_list.yaml}. The \textit{assembly\_name} is the assembly which the component connections should come from, and the rest of the model file name must remain as shown. Generally this file is created in the same directory or near to the assembly model file. The schema is commented to show what each of the available YAML keys are and what they accomplish. Even without knowing the specifics of pykwalify schemas, you should be able to gleam some knowledge from the file below.

\yamlcodef{../schemas/task_watchdog_list.yaml}

\section{Example Input}

The following shows an example input YAML model that is used in the unit testing for the task watchdog component. The example attempts to use all the variations of the optional inputs so that the user can see how they can use the options to generate their own desired input. Generally this file is created in the same directory or near to the assembly model file. This example adheres to the schema shown in the previous section, and is commented to give clarification.

\yamlcodef{../../test/test_assembly/test_assembly.task_watchdog_list.yaml}

As can be seen, specifying a petter consist of at least a connector name, a limit, an action, and the criticality. There is also the capability to include a name which will be used as the name of the generated data products and faults. If no name is specified, the generator will use a autogenerated name using the connector name. 

\section{Example Output}

The example input shown in the previous section produces the following Ada output. The \texttt{Downsample\_List} variable should be passed into the Task Watchdog component's \texttt{Init} procedure during assembly initialization.

The main job of the generator in this case was to verify the input YAML for validity and then to translate the data to an Ada data structure for use by the component. The generator will also create data products and faults as was mentioned before in this document

\adacodef{../../test/test_assembly/build/src/test_assembly_task_watchdog_list.ads}

\end{document}
