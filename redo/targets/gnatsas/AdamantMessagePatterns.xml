<?xml version="1.0"?>

<!-- This file provides additional message patterns for -->
<!-- GNAT SAS, adapted for the Adamant architecture.    -->
<!-- This is to be used in addition to the GNAT SAS -->
<!-- provided MessagePatterns.xml, a copy of which is   -->
<!-- also provided in this directory                    -->

<!-- This file specifies pattern-matching rules for  -->
<!-- determining the error probability level -->
<!-- assigned to each GNAT SAS-identified problem. -->
<!-- The rules may be overridden by a GNAT SAS option; -->
<!-- see the documentation for more information. -->
<!-- Note: the order is not significant, so add new rules at the end, -->
<!-- and update the number, which is printed out in the debug traces for -->
<!-- pattern matching. -->

<!-- You can check this file against an XSD schema. On Linux, the command is

       xmllint -noout -schema MessagePatterns.xsd MessagePatterns.xml

     (replace the simple '-' by double '-') -->

<Message_Probability_Rules>

<!-- For information on how to write these read the documentation here: -->
<!-- https://docs.adacore.com/live/wave/codepeer/html/codepeer_ug/appendix.html#format-of-messagepatterns-xml-file -->

<!--117-->
<!-- If an unused output parameter is named "ignore" than -->
<!-- this is intentional and the warning should be suppressed. -->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <String_Specifier
      Name_Of_String_Attribute="Check_Kind"
      String_To_Match="DEAD_OUTPARAM_STORE_WARNING">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Text"
      String_To_Match="*[Ii]gnore*">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>
<!--118-->
<!-- low warning: unused assignment [CWE 563] into ignore -->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <String_Specifier
      Name_Of_String_Attribute="Check_Kind"
      String_To_Match="DEAD_STORE_WARNING">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Text"
      String_To_Match="*[Ii]gnore*">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>

<!-- Suppress warnings from unit test files -->
<!-- We still need CodePeer to analyze these -->
<!-- files so we get reports on any instantiated -->
<!-- generics, but we can ignore any warnings -->
<!-- generated by the unit test files themselves. -->

<!--119-->
<!-- Suppress all tester files in test directory. -->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <String_Specifier
      Name_Of_String_Attribute="Directory"
      String_To_Match="*test*">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="File"
      String_To_Match="*-tester.ad[sb]">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>

<!--120-->
<!-- Suppress all test main files in test directory. -->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <String_Specifier
      Name_Of_String_Attribute="Directory"
      String_To_Match="*test*">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="File"
      String_To_Match="test.adb">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>

<!--121-->
<!-- Suppress all implementation files in test directory. -->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <String_Specifier
      Name_Of_String_Attribute="Directory"
      String_To_Match="*test*">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="File"
      String_To_Match="*tests-implementation.ad[sb]">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>

<!-- Component source code rules. -->

<!--122-->
<!-- Suppress all access check failures on arrayed connectors -->
<!-- that might be null. These get instantiated at Init by autocode -->
<!-- so this is very unlikely to occur in practice. -->
<!-- Example: -->
<!-- access check [CWE 476] might fail: requires self.all.connector_Command_Response_T_To_Forward_Send /= null -->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <String_Specifier
      Name_Of_String_Attribute="Check_Kind"
      String_To_Match="INVALID_OR_NULL_CHECK">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Text"
      String_To_Match="Self.All.Connector_* /= null">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>

<!-- Suppress all access check failures on calls to connectors with if_connected -->
<!-- that might be null. These get instantiated at Init by autocode. -->
<!-- Example: -->
<!-- precondition (access check [CWE 476]) might fail on call to component.command_router.command_t_send_if_connected: requires not self.connector_Command_T_Send(1..2**16-1).connected or self.connector_Command_T_Send(1..2**16-1).component_Access /= null access check [CWE 476] might fail: requires self.all.connector_Command_Response_T_To_Forward_Send /= null -->
<!--123-->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <String_Specifier
      Name_Of_String_Attribute="Check_Kind"
      String_To_Match="PRECONDITION_CHECK">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Likelihood"
      String_To_Match="CHECK_MIGHT_FAIL">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Text"
      String_To_Match="*Self.Connector_*.Connected*or*Self.Connector_*.Component_Access /= null*">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>
<!--124-->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <String_Specifier
      Name_Of_String_Attribute="Check_Kind"
      String_To_Match="PRECONDITION_CHECK">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Likelihood"
      String_To_Match="CHECK_MIGHT_FAIL">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Text"
      String_To_Match="*Self.Connector_*.Connected*or*Self.Connector_*.Hook /= null*">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>
<!--125-->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <String_Specifier
      Name_Of_String_Attribute="Check_Kind"
      String_To_Match="PRECONDITION_CHECK">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Likelihood"
      String_To_Match="CHECK_MIGHT_FAIL">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Text"
      String_To_Match="*Self.Connector_*.Component_Access /= null*">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>
<!--126-->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <String_Specifier
      Name_Of_String_Attribute="Check_Kind"
      String_To_Match="PRECONDITION_CHECK">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Likelihood"
      String_To_Match="CHECK_MIGHT_FAIL">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Text"
      String_To_Match="*Self.Connector_*.Hook /= null*">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>
<!--127-->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <String_Specifier
      Name_Of_String_Attribute="Check_Kind"
      String_To_Match="PRECONDITION_CHECK">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Likelihood"
      String_To_Match="CHECK_MIGHT_FAIL">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Text"
      String_To_Match="*Self.Connector_*.Connected = true*">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>
<!--128-->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <String_Specifier
      Name_Of_String_Attribute="Check_Kind"
      String_To_Match="PRECONDITION_CHECK">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Likelihood"
      String_To_Match="CHECK_MIGHT_FAIL">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Text"
      String_To_Match="*Component.*_Connector.Call.Self.Connected = true*">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>
<!--129-->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <String_Specifier
      Name_Of_String_Attribute="Check_Kind"
      String_To_Match="PRECONDITION_CHECK">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Likelihood"
      String_To_Match="CHECK_MIGHT_FAIL">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Text"
      String_To_Match="*Component.*_Connector.Call.Self.Hook /= null*">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>
<!--130-->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <String_Specifier
      Name_Of_String_Attribute="Check_Kind"
      String_To_Match="PRECONDITION_CHECK">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Likelihood"
      String_To_Match="CHECK_MIGHT_FAIL">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Text"
      String_To_Match="*Component.*_Connector.Call.Self.Component_Access /= null*">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>

<!-- Suppress autocode level code where some code might be dead due to the nature of -->
<!-- some types never being able to be invalid. -->
<!--131-->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <Bool_Specifier Name_Of_Boolean_Attribute="Is_Infer_Message"/>
    <String_Specifier
      Name_Of_String_Attribute="Check_Kind"
      String_To_Match="test always true">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="File"
      String_To_Match="component-*.adb">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Text"
      String_To_Match="*Cmd_Execution_Stat = 0*">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>
<!--132-->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <String_Specifier
      Name_Of_String_Attribute="Check_Kind"
      String_To_Match="DEAD_BLOCK_WARNING">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="File"
      String_To_Match="component-*.adb">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Text"
      String_To_Match="*Cmd_Execution_Stat = Success*">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>
<!--133-->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <Bool_Specifier Name_Of_Boolean_Attribute="Is_Infer_Message"/>
    <String_Specifier
      Name_Of_String_Attribute="Check_Kind"
      String_To_Match="test always true">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="File"
      String_To_Match="component-*.adb">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Text"
      String_To_Match="*Push_Stat = 0*">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>
<!--134-->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <Bool_Specifier Name_Of_Boolean_Attribute="Is_Infer_Message"/>
    <String_Specifier
      Name_Of_String_Attribute="Check_Kind"
      String_To_Match="test always false">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="File"
      String_To_Match="component-*.adb">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Text"
      String_To_Match="*Push_Stat = 2*">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>
<!--135-->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <String_Specifier
      Name_Of_String_Attribute="Check_Kind"
      String_To_Match="DEAD_BLOCK_WARNING">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="File"
      String_To_Match="component-*.adb">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Text"
      String_To_Match="*Push_Stat* = Success*">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>
<!--136-->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <String_Specifier
      Name_Of_String_Attribute="Check_Kind"
      String_To_Match="TRUE_DEAD_EDGE_WARNING">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="File"
      String_To_Match="component-*.adb">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Text"
      String_To_Match="*Push_Stat* = Success*">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>
<!--137-->
<!-- medium: precondition (user precondition, range check [CWE 682]) might fail on call to cryo_interface_events.writing_to_special_register_disallowed: requires Self.Id_Base <= 2**16-23 -->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <String_Specifier
      Name_Of_String_Attribute="Check_Kind"
      String_To_Match="PRECONDITION_CHECK">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Original_Check_Kind"
      String_To_Match="NUMERIC_RANGE_CHECK">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Likelihood"
      String_To_Match="CHECK_MIGHT_FAIL">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Text"
      String_To_Match="*requires Self.Id_Base ?=*">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>
<!--138-->
<!-- parameters are always initialized by autocode, so we can ignore these warnings -->
<!-- medium: validity check [CWE 457]: Self.all.Freq_Test_Feed_Forward.Value might be uninitialized -->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <String_Specifier
      Name_Of_String_Attribute="Check_Kind"
      String_To_Match="INVALID_CHECK">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="File"
      String_To_Match="component-*-implementation.adb">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Likelihood"
      String_To_Match="CHECK_MIGHT_FAIL">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Text"
      String_To_Match="*Self.all.*.*">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>
<!--139-->
<!-- It is understood that floating point operations must remain in range to be valid and we are to avoid nans. -->
<!-- low: overflow check [CWE 190] might fail: requires Self.all.T2 + Acceleration_Time in IEEE_32_Float -->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <String_Specifier
      Name_Of_String_Attribute="Check_Kind"
      String_To_Match="NUMERIC_OVERFLOW_CHECK">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Likelihood"
      String_To_Match="CHECK_MIGHT_FAIL">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Text"
      String_To_Match="*in IEEE_{32,64}_Float*">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>
<!--140-->
<!-- It is understood that floating point operations must remain in range to be valid and we are to avoid nans. -->
<!-- medium: precondition (overflow check [CWE 190]) might fail on call to component.aperture_wheel_manager.implementation.send_aw_control_data: requires Self.Commanded_Angle - Measured_Value in IEEE_32_Float -->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <String_Specifier
      Name_Of_String_Attribute="Check_Kind"
      String_To_Match="PRECONDITION_CHECK">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Likelihood"
      String_To_Match="CHECK_MIGHT_FAIL">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Text"
      String_To_Match="*in IEEE_{32,64}_Float*">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>
<!--141-->
<!-- It is understood that floating point operations must remain in range to be valid and we are to avoid nans. -->
<!-- medium: precondition (overflow check [CWE 190]) might fail on call to component.aperture_wheel_manager.implementation.move_aperture_wheel.set_commanded_angle: requires ... Self.Trajectory_Generator_Inputs.Acceleration &lt;= IEEE_32_Float'Last -->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <String_Specifier
      Name_Of_String_Attribute="Check_Kind"
      String_To_Match="PRECONDITION_CHECK">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Likelihood"
      String_To_Match="CHECK_MIGHT_FAIL">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Text"
      String_To_Match="*&lt;= IEEE_{32,64}_Float'Last*">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>
<!--142-->
<!-- ignores for common connectors -->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <String_Specifier
      Name_Of_String_Attribute="Check_Kind"
      String_To_Match="PRECONDITION_CHECK">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Likelihood"
      String_To_Match="CHECK_MIGHT_FAIL">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Text"
      String_To_Match="*common_connectors.*.call.Self.Hook /= null*">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>
<!--143-->
<!-- ignores for common connectors -->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <String_Specifier
      Name_Of_String_Attribute="Check_Kind"
      String_To_Match="PRECONDITION_CHECK">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Likelihood"
      String_To_Match="CHECK_MIGHT_FAIL">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Text"
      String_To_Match="*common_connectors.*.call.Self.Connected = true*">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>
<!--144-->
<!-- ignores for common connectors -->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <String_Specifier
      Name_Of_String_Attribute="Check_Kind"
      String_To_Match="PRECONDITION_CHECK">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Likelihood"
      String_To_Match="CHECK_MIGHT_FAIL">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Text"
      String_To_Match="*common_connectors.*.call.Self.Component_Access /= null*">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>
<!--145-->
<!-- ignores precondition (tag check [CWE 136]) might fail on call to component.cryo_interface.command_t_recv_async_hook: requires Class_Self'Tag in {component.cryo_interface.base_instance, component.cryo_interface.implementation.instance} -->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <String_Specifier
      Name_Of_String_Attribute="Check_Kind"
      String_To_Match="PRECONDITION_CHECK">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Original_Check_Kind"
      String_To_Match="TAG_CHECK">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="Likelihood"
      String_To_Match="CHECK_MIGHT_FAIL">
    </String_Specifier>
    <String_Specifier
        Name_Of_String_Attribute="Text"
        String_To_Match="*Class_Self'Tag*">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="File"
      String_To_Match="component-*-implementation.adb">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>
<!--146-->
<!-- ignores medium warning: useless reassignment of Variable_Length -->
<Message_Rule Matching_Probability="SUPPRESSED">
  <Message_Pattern>
    <String_Specifier
      Name_Of_String_Attribute="Check_Kind"
      String_To_Match="SAME_VALUE_DEAD_STORE_WARNING">
    </String_Specifier>
    <String_Specifier
        Name_Of_String_Attribute="Text"
        String_To_Match="*Variable_Length*">
    </String_Specifier>
    <String_Specifier
      Name_Of_String_Attribute="File"
      String_To_Match="*-validation.adb">
    </String_Specifier>
  </Message_Pattern>
</Message_Rule>
</Message_Probability_Rules>
